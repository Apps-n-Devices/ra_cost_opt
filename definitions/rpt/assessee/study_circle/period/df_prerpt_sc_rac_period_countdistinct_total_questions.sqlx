config {
  type: "table",
  dependencies: ["df_prerpt_sc_rac_period_measures"]
}
pre_operations {
    SET @@query_label =
      "step:df_prerpt_sc_rac_period_countdistinct_total_questions, " ||
      "batch_id: ${dataform.projectConfig.vars.batch_id}";
}
SELECT   
  -- --primary keys
      study_circle_id
    , dim_ra_cube_id
    , assessment_academic_period_id
    , (
      SELECT COUNT(1) FROM UNNEST(arr_assessment_questions)
    ) AS countdistinct_total_questions
FROM readanalytics.df_prerpt_sc_rac_period_measures

